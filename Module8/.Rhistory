hist(rpois(10000, lambda = 5))
abline(v = 8, col = "red", lwd = 3)
# Poisson distribution histogram
hist(rpois(10000, lambda = 5), main = "Poisson Distribution (lambda=5)", xlab = "Value", col = "lightblue", border = "black")
abline(v = 8, col = "red", lwd = 3)
# Exponential distribution histogram
hist(rexp(10000, rate = 0.2), main = "Exponential Distribution (rate=0.2)", xlab = "Value", col = "lightgreen", border = "black")
# Normal distribution histogram
hist(rnorm(10000, mean = 0, sd = 1), main = "Normal Distribution (mean=0, sd=1)", xlab = "Value", col = "lightpink", border = "black")
# Uniform distribution histogram
hist(runif(10000, min = 0, max = 10), main = "Uniform Distribution (0 to 10)", xlab = "Value", col = "lightyellow", border = "black")
abline(v = 8, col = "red", lwd = 3)
# Exponential distribution histogram
hist(rexp(10000, rate = 0.2), main = "Exponential Distribution (rate=0.2)", xlab = "Value", col = "lightgreen", border = "black")
# Normal distribution histogram
hist(rnorm(10000, mean = 0, sd = 1), main = "Normal Distribution (mean=0, sd=1)", xlab = "Value", col = "lightpink", border = "black")
# Uniform distribution histogram
hist(runif(10000, min = 0, max = 10), main = "Uniform Distribution (0 to 10)", xlab = "Value", col = "lightyellow", border = "black")
library(dplyr)
#Monte Carlo Simulation in R
# Creating the population
population <- rexp(10000000, rate = 0.10)
# Identifying the truth
truth <- mean(population)
# Initializing parameters
test <- NULL
n <- 50
a <- 0.05
#Dr. Octavious Smiley CI 27
#Monte Carlo Simulation in R
# Monte Carlo Simulations
for(i in 1:1000){
# Taking random sample
monte_sample <- sample(population, size = n)
# Finding mean
x_bar <- mean(monte_sample)
# Calculating the standard error
s.e <- sd(monte_sample)/sqrt(n)
# Calculating the quantile
z_a <- qnorm(1 - a/2)
# Creating confidence interval
confidence_interval <- c(x_bar - s.e*z_a, x_bar + s.e*z_a)
# Checking if confidence interval has the truth
if(between(truth, confidence_interval[1], confidence_interval[2])){
test[i] <- 1
} else {
test[i] <- 0
}
}
# Determining what proportion of intervals contain the truth
# Should be 1 - alpha
mean(test)
#Dr. Octavious Smiley CI 28
# Population proportion
omega_0 <- 0.15
n <- 150000
omega_hat <- 0.1513
z <- (omega_hat - omega_0)/sqrt(omega_0*(1 - omega_0)/n)
x <- seq(-5, 5, length.out = 1000)
pdf <- dnorm(x, mean = 0, sd = 1)
theoretical <- data.frame(x = x, pdf = pdf)
ggplot() + geom_polygon(data = theoretical, mapping = aes(x = x, y = pdf), alpha = 0.5, color = "grey", fill = "grey") + labs(x = "z-statistic", y = "Probability density") + geom_vline(xintercept = z)
#Monte Carlo Simulation in R
# Creating the population
population <- rexp(10000000, rate = 0.10)
# Identifying the truth
truth <- mean(population)
# Initializing parameters
test <- NULL
n <- 50
a <- 0.05
n <- 50
a <- 0.05
#Monte Carlo Simulation in R
# Monte Carlo Simulations
for(i in 1:1000){
# Taking random sample
monte_sample <- sample(population, size = n)
# Finding mean
x_bar <- mean(monte_sample)
# Calculating the standard error
s.e <- sd(monte_sample)/sqrt(n)
# Calculating the quantile
z_a <- qnorm(1 - a/2)
# Creating confidence interval
confidence_interval <- c(x_bar - s.e*z_a, x_bar + s.e*z_a)
# Checking if confidence interval has the truth
if(between(truth, confidence_interval[1], confidence_interval[2])){
test[i] <- 1
} else {
test[i] <- 0
}
}
# Determining what proportion of intervals contain the truth
# Should be 1 - alpha
mean(test)
# Population proportion
omega_0 <- 0.15
n <- 150000
omega_hat <- 0.1513
z <- (omega_hat - omega_0)/sqrt(omega_0*(1 - omega_0)/n)
x <- seq(-5, 5, length.out = 1000)
pdf <- dnorm(x, mean = 0, sd = 1)
theoretical <- data.frame(x = x, pdf = pdf)
ggplot() + geom_polygon(data = theoretical, mapping = aes(x = x, y = pdf), alpha = 0.5, color = "grey", fill = "grey") + labs(x = "z-statistic", y = "Probability density") + geom_vline(xintercept = z)
theoretical <- data.frame(x = x, pdf = pdf)
ggplot() + geom_polygon(data = theoretical, mapping = aes(x = x, y = pdf), alpha = 0.5, color = "grey", fill = "grey") + labs(x = "z-statistic", y = "Probability density") + geom_vline(xintercept = z)
library(dplyr)
library(ggplot2)
#Monte Carlo Simulation in R
# Creating the population
population <- rexp(10000000, rate = 0.10)
# Identifying the truth
truth <- mean(population)
# Initializing parameters
test <- NULL
n <- 50
a <- 0.05
#Monte Carlo Simulation in R
# Monte Carlo Simulations
for(i in 1:1000){
# Taking random sample
monte_sample <- sample(population, size = n)
# Finding mean
x_bar <- mean(monte_sample)
# Calculating the standard error
s.e <- sd(monte_sample)/sqrt(n)
# Calculating the quantile
z_a <- qnorm(1 - a/2)
# Creating confidence interval
confidence_interval <- c(x_bar - s.e*z_a, x_bar + s.e*z_a)
# Checking if confidence interval has the truth
if(between(truth, confidence_interval[1], confidence_interval[2])){
test[i] <- 1
} else {
test[i] <- 0
}
}
# Determining what proportion of intervals contain the truth
# Should be 1 - alpha
mean(test)
# Population proportion
omega_0 <- 0.15
n <- 150000
omega_hat <- 0.1513
z <- (omega_hat - omega_0)/sqrt(omega_0*(1 - omega_0)/n)
x <- seq(-5, 5, length.out = 1000)
pdf <- dnorm(x, mean = 0, sd = 1)
theoretical <- data.frame(x = x, pdf = pdf)
ggplot() + geom_polygon(data = theoretical, mapping = aes(x = x, y = pdf), alpha = 0.5, color = "grey", fill = "grey") + labs(x = "z-statistic", y = "Probability density") + geom_vline(xintercept = z)
# Significant Tests Significance Tests for Proportions Significance Tests for Means Summary
# Significance Tests for a Proportion
# Example: In the year 2010, the poverty rate in the United
# States was around 15%. In 2011, the rate was measured at
# 15.13% with a sample size of 150, 000, as reported by the
# United States Census Bureau. Does the poverty rate increase
# during 2010 and 2011?
# Significant Tests Significance Tests for Proportions Significance Tests for Means Summary
# Significance Tests for a Proportion
# Example: In the year 2010, the poverty rate in the United
# States was around 15%. In 2011, the rate was measured at
# 15.13% with a sample size of 150,000, as reported by the
# United States Census Bureau. Does the poverty rate increase
# during 2010 and 2011?
# Given data
p0 <- 0.15          # Proportion in 2010
p_hat <- 0.1513     # Proportion in 2011
n <- 150000         # Sample size in 2011
# Null hypothesis: p = 0.15 (poverty rate did not increase)
# Alternative hypothesis: p > 0.15 (poverty rate increased)
# Calculate the test statistic (z)
z <- (p_hat - p0) / sqrt(p0 * (1 - p0) / n)
# Calculate the p-value for one-sided test
p_value <- 1 - pnorm(z)
# Output the test statistic and p-value
cat("Test statistic (z):", z, "\n")
cat("P-value:", p_value, "\n")
# Conclusion at significance level alpha = 0.05
if (p_value < 0.05) {
cat("Reject the null hypothesis: There is evidence that the poverty rate increased from 2010 to 2011.\n")
} else {
cat("Fail to reject the null hypothesis: There is not enough evidence to conclude the poverty rate increased.\n")
}
# Calculate the test statistic (z)
z <- (p_hat - p0) / sqrt(p0 * (1 - p0) / n)
cat("Test statistic (z):", z, "\n")
# Calculate the p-value for one-sided test
p_value <- 1 - pnorm(z)
cat("P-value:", p_value, "\n")
# Significance Tests for a Proportion
# Example: In the year 2010, the poverty rate in the United
# States was around 15%. In 2011, the rate was measured at
# 15.13% with a sample size of 150,000, as reported by the
# United States Census Bureau. Does the poverty rate increase
# during 2010 and 2011?
# Given data
p0 <- 0.15          # Proportion in 2010
p_hat <- 0.1513     # Proportion in 2011
n <- 150000         # Sample size in 2011
# Null hypothesis: p = 0.15 (poverty rate did not increase)
# Alternative hypothesis: p > 0.15 (poverty rate increased)
# Calculate the test statistic (z)
z <- (p_hat - p0) / sqrt(p0 * (1 - p0) / n)
cat("Test statistic (z):", z, "\n")
# Calculate the p-value for one-sided test
p_value <- 1 - pnorm(z)
cat("P-value:", p_value, "\n")
# Plot the normal distribution and shade the rejection region
x <- seq(-4, 4, length=1000)
y <- dnorm(x)
plot(x, y, type="l", lwd=2, main="Z-test for Proportion",
ylab="Density", xlab="Z value")
# Shade the rejection region (right tail)
z_critical <- qnorm(0.95)
polygon(c(z_critical, x[x >= z_critical], max(x)),
c(0, y[x >= z_critical], 0),
col="red", border=NA)
# Add the observed z value
points(z, dnorm(z), pch=19, col="blue")
text(z, dnorm(z), labels=paste0("z = ", round(z, 3)), pos=4, col="blue")
# Add vertical line for critical value
abline(v=z_critical, col="red", lty=2)
# Conclusion at significance level alpha = 0.05
if (p_value < 0.05) {
cat("Reject the null hypothesis: There is evidence that the poverty rate increased from 2010 to 2011.\n")
} else {
cat("Fail to reject the null hypothesis: There is not enough evidence to conclude the poverty rate increased.\n")
}
library(ggplot2)
# Significance Tests for a Proportion
# Example: In the year 2010, the poverty rate in the United
# States was around 15%. In 2011, the rate was measured at
# 15.13% with a sample size of 150,000, as reported by the
# United States Census Bureau. Does the poverty rate increase
# during 2010 and 2011?
# Given data
p0 <- 0.15          # Proportion in 2010
p_hat <- 0.1513     # Proportion in 2011
n <- 150000         # Sample size in 2011
# Null hypothesis: p = 0.15 (poverty rate did not increase)
# Alternative hypothesis: p > 0.15 (poverty rate increased)
# Calculate the test statistic (z)
z <- (p_hat - p0) / sqrt(p0 * (1 - p0) / n)
cat("Test statistic (z):", z, "\n")
# Calculate the p-value for one-sided test
p_value <- 1 - pnorm(z)
cat("P-value:", p_value, "\n")
# Prepare data for ggplot
x <- seq(-4, 4, length=1000)
y <- dnorm(x)
df <- data.frame(x = x, y = y)
# Critical value for 0.05 significance level
z_critical <- qnorm(0.95)
# Plot using ggplot2
ggplot(df, aes(x = x, y = y)) +
geom_line(size = 1) +
geom_ribbon(data = subset(df, x >= z_critical), aes(ymax = y), ymin = 0, fill = "red", alpha = 0.5) +
geom_vline(xintercept = z_critical, linetype = "dashed", color = "red") +
geom_point(aes(x = z, y = dnorm(z)), color = "blue", size = 3) +
geom_text(aes(x = z, y = dnorm(z), label = paste0("z = ", round(z, 3))), hjust = -0.1, color = "blue") +
labs(title = "Z-test for Proportion",
x = "Z value",
y = "Density") +
theme_minimal()
# Conclusion at significance level alpha = 0.05
if (p_value < 0.05) {
cat("Reject the null hypothesis: There is evidence that the poverty rate increased from 2010 to 2011.\n")
} else {
cat("Fail to reject the null hypothesis: There is not enough evidence to conclude the poverty rate increased.\n")
}
